# Тетрис - Веб-приложение

Полнофункциональное веб-приложение "Тетрис" с системой учёта пользователей и рейтингов. Реализовано на Vue3 + Node.js + MongoDB.

## Технологии

### Фронтенд
- Vue 3 (Composition API)
- Vite
- Pinia (управление состоянием)
- Vue Router
- SCSS
- Axios

### Бэкенд
- Node.js
- Express.js
- MongoDB (Mongoose)
- JWT (аутентификация)
- bcryptjs (хеширование паролей)

## Структура проекта

```
my-tetris/
├── backend/
│   ├── controllers/      # Контроллеры для обработки запросов
│   ├── models/          # Модели MongoDB
│   ├── routes/          # Маршруты API
│   ├── middleware/      # Middleware (аутентификация)
│   ├── app.js           # Главный файл сервера
│   └── package.json
├── frontend/
│   ├── src/
│   │   ├── components/  # Vue компоненты
│   │   ├── views/       # Страницы приложения
│   │   ├── store/       # Pinia stores
│   │   ├── services/    # API сервисы
│   │   ├── assets/      # Стили и ресурсы
│   │   ├── router.js    # Конфигурация роутера
│   │   └── main.js      # Точка входа
│   ├── index.html
│   ├── vite.config.js
│   └── package.json
└── README.md
```

## Установка и запуск

### Предварительные требования

- Node.js (версия 16 или выше)
- MongoDB (локально или MongoDB Atlas)
- Yarn (или npm)

### 1. Установка зависимостей

#### Бэкенд
```bash
cd backend
yarn install
```

#### Фронтенд
```bash
cd frontend
yarn install
```

### 2. Настройка окружения

#### Бэкенд

Создайте файл `.env` в папке `backend/` на основе `.env.example`:

```env
PORT=3000
MONGODB_URI=mongodb://localhost:27017/tetris
JWT_SECRET=your-secret-key-change-in-production
NODE_ENV=development
```

**Важно:** Замените `JWT_SECRET` на случайную строку для безопасности в production.

#### Фронтенд

Создайте файл `.env` в папке `frontend/` (опционально):

```env
VITE_API_URL=http://localhost:3000/api
```

Если не указан, используется значение по умолчанию: `http://localhost:3000/api`

### 3. Запуск MongoDB

Убедитесь, что MongoDB запущен локально:

```bash
# Если MongoDB установлен локально
mongod

# Или используйте MongoDB Atlas (облачная версия)
# В этом случае укажите URI в .env файле
```

### 4. Запуск приложения

#### Запуск бэкенда

В терминале:
```bash
cd backend
yarn start
```

Сервер запустится на `http://localhost:3000`

#### Запуск фронтенда

В другом терминале:
```bash
cd frontend
yarn dev
```

Приложение откроется на `http://localhost:5173`

## Использование

### Регистрация и вход

1. Откройте приложение в браузере
2. Зарегистрируйтесь, указав имя, email и пароль
3. После регистрации вы автоматически войдёте в систему

### Игра

#### Управление (клавиатура)
- **←** / **→** - движение влево/вправо
- **↓** - ускоренное падение
- **↑** / **Пробел** - поворот фигуры
- **P** - пауза/продолжить

#### Управление (мобильные устройства)
- **Свайп влево/вправо** - движение
- **Свайп вниз** - жёсткое падение
- **Кнопка поворота** - поворот фигуры
- **Кнопка падения** - быстрое падение

### Функции

- **Игровое поле**: 10×20 клеток
- **Подсчёт очков**: по классическим правилам Тетриса
- **Уровни**: увеличиваются каждые 10 очищенных линий
- **Следующая фигура**: отображается в боковой панели
- **Пауза**: возможность приостановить игру
- **Автосохранение**: результаты автоматически сохраняются в базу данных

### Рейтинг

- Просмотр топ-10 игроков
- Личная статистика в профиле
- Лучший результат, средний результат, количество игр

### Профиль

- Просмотр информации о пользователе
- Личная статистика
- Смена пароля

## API Endpoints

### Аутентификация
- `POST /api/auth/register` - Регистрация
- `POST /api/auth/login` - Вход

### Результаты
- `POST /api/scores/submit` - Сохранение результата (требует аутентификации)
- `GET /api/scores/top` - Получение топ-10
- `GET /api/scores/my` - Личная статистика (требует аутентификации)

### Пользователь
- `GET /api/user/profile` - Получение профиля (требует аутентификации)
- `POST /api/user/change-password` - Смена пароля (требует аутентификации)

## Особенности реализации

### Игровая логика
- Классические правила Тетриса
- 7 типов фигур (I, O, T, S, Z, J, L)
- Система поворотов с проверкой коллизий
- Автоматическое очищение заполненных линий
- Прогрессивное увеличение скорости

### Безопасность
- Хеширование паролей (bcrypt)
- JWT токены для аутентификации
- Валидация данных на сервере
- Защита маршрутов middleware

### Адаптивность
- Полная поддержка мобильных устройств
- Сенсорное управление
- Оптимизированный интерфейс для маленьких экранов
- Адаптивные размеры элементов

### Анимации
- Плавные переходы для фигур
- CSS-анимации для UI элементов
- Визуальная обратная связь при взаимодействии

## Разработка

### Сборка для production

#### Фронтенд
```bash
cd frontend
yarn build
```

Собранные файлы будут в папке `frontend/dist/`

#### Бэкенд
Бэкенд готов к production после установки зависимостей.

### Отладка

- Логи сервера выводятся в консоль
- Ошибки клиента отображаются в консоли браузера
- Используйте Vue DevTools для отладки состояния

## Решение проблем

### MongoDB не подключается
- Убедитесь, что MongoDB запущен
- Проверьте URI в `.env` файле
- Для MongoDB Atlas проверьте настройки сети и доступ

### Ошибки аутентификации
- Проверьте, что токен сохраняется в localStorage
- Убедитесь, что JWT_SECRET одинаковый на сервере
- Очистите localStorage и войдите заново

### Проблемы с CORS
- Убедитесь, что бэкенд запущен на порту 3000
- Проверьте настройки CORS в `app.js`

## Лицензия

Этот проект создан в образовательных целях.

## Автор

Создано с использованием Vue 3, Node.js и MongoDB.

